(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{129:function(e,t,a){e.exports=a(224)},134:function(e,t,a){},223:function(e,t,a){},224:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),c=a.n(o),l=(a(134),a(32)),i=(a(135),a(91),a(136),function(e){console.log("props",e);gantt.ext.zoom.init({levels:[{name:"Days",scale_height:60,min_column_width:70,scales:[{unit:"week",step:1,format:"Week #%W"},{unit:"day",step:1,format:"%d %M"}]},{name:"Months",scale_height:60,min_column_width:70,scales:[{unit:"month",step:1,format:"%F"},{unit:"week",step:1,format:"#%W"}]},{name:"Years",scale_height:60,min_column_width:70,scales:[{unit:"year",step:1,format:"%Y"},{unit:"month",step:1,format:"#%F"}]}]});return function(e){gantt.ext.zoom.setLevel(e);var t="Years"===e||"Months"===e;gantt.templates.timeline_cell_class=function(e,a){return t||0!==a.getDay()&&6!==a.getDay()?"":"weekend"}}(e.zoom),Object(n.useEffect)(function(){gantt.config.xml_date="%Y-%m-%d %H:%i",gantt.config.server_utc=!0,gantt.config.readonly=!0,gantt.config.columns=[{name:"text",label:"\u4efb\u52a1\u540d\u79f0",min_width:300,tree:!0},{name:"start_date",label:"\u5f00\u59cb\u65e5\u671f",align:"center",min_width:100},{name:"end_date",label:"\u7ed3\u675f\u65e5\u671f",align:"center",min_width:100},{name:"username",label:"\u6307\u6d3e\u7ed9",align:"center",min_width:100},{name:"duration",label:"\u6301\u7eed\u5929\u6570",align:"center"},{name:"progress",label:"\u8fdb\u5ea6",align:"center"}],gantt.i18n.setLocale("cn"),gantt.plugins({tooltip:!0}),gantt.config.open_tree_initially=!0,gantt.init("gantt"),gantt.templates.tooltip_text=function(e,t,a){return a.text}},[]),Object(n.useEffect)(function(){gantt.parse({data:e.data}),gantt.render()}),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"gantt-box"},r.a.createElement("div",{id:"gantt"})))}),u=a(87),s=a.n(u),m=a(114),f=a(33),d=a(115),g=function(e,t){switch(t.type){case"FETCH_INIT":return Object(f.a)(Object(f.a)({},e),{},{loading:!0,error:!1});case"FETCH_SUCCESS":return Object(f.a)(Object(f.a)({},e),{},{loading:!1,error:!1,data:t.payload});case"FETCH_ERROR":return Object(f.a)(Object(f.a)({},e),{},{loading:!1,error:!0});default:throw new Error("error")}},E=a(116),p=a.n(E),v=a(126),h=p.a.create({timeout:5e3});h.interceptors.request.use(function(e){return e},function(e){return console.log(e),Promise.reject(e)}),h.interceptors.response.use(function(e){var t=e.data;if(200===t.code)return t;v.b.error(t.message)},function(e){return v.b.error(e.message),Promise.reject(e)});var b=h;function _(e){return b({url:"/zentao/gantt",method:"post",data:e})}var j=a(227),O=a(226),w=a(228),y=a(124),C=j.a.Option,x=function(e){var t=Object(n.useState)(""),a=Object(l.a)(t,2),o=a[0],c=a[1],i=Object(n.useState)(""),u=Object(l.a)(i,2),s=u[0],m=u[1],f=Object(n.useState)(null),d=Object(l.a)(f,2);d[0],d[1];Object(n.useLayoutEffect)(function(){var e=gantt.attachEvent("onBeforeTaskDisplay",function(e,t){return!o||t.username.indexOf(o)>-1},{});return gantt.refreshData(),function(){gantt.detachEvent(e)}},[o]),Object(n.useLayoutEffect)(function(){var e=gantt.attachEvent("onBeforeTaskDisplay",function(e,t){return!s||t.dept===s},{});return gantt.refreshData(),function(){gantt.detachEvent(e)}},[s]);return r.a.createElement("div",{className:"filter"},r.a.createElement(O.a,{name:"\u641c\u7d22",layout:"inline",onFinish:function(e){c(e.person),gantt.render()}},r.a.createElement(O.a.Item,{name:"person",label:"\u4eba\u5458"},r.a.createElement(w.a,{style:{width:150},value:o,allowClear:!0})),r.a.createElement(O.a.Item,null,r.a.createElement(y.a,{type:"primary",htmlType:"submit"},"\u641c\u7d22")),r.a.createElement(O.a.Item,{name:"dept",label:"\u6309\u7ec4\u7ec7\u67b6\u6784\u8fc7\u6ee4"},r.a.createElement(j.a,{allowClear:!0,value:s,style:{width:150},onChange:function(e){console.log(e),m(e)}},r.a.createElement(C,{value:"\u4ea7\u54c1"},"\u4ea7\u54c1"),r.a.createElement(C,{value:"UI"},"UI"),r.a.createElement(C,{value:"\u524d\u7aef"},"\u524d\u7aef"),r.a.createElement(C,{value:"erp\u540e\u53f0"},"erp\u540e\u53f0"),r.a.createElement(C,{value:"\u5546\u57ce\u540e\u53f0"},"\u5546\u57ce\u540e\u53f0"),r.a.createElement(C,{value:"java\u5f00\u53d1"},"java\u5f00\u53d1"),r.a.createElement(C,{value:"\u5b89\u5353\u5ba2\u6237\u7aef"},"\u5b89\u5353\u5ba2\u6237\u7aef"),r.a.createElement(C,{value:"ios\u5ba2\u6237\u7aef"},"ios\u5ba2\u6237\u7aef"),r.a.createElement(C,{value:"\u5927\u6570\u636e\u5f00\u53d1\u7ec4"},"\u5927\u6570\u636e\u5f00\u53d1\u7ec4"),r.a.createElement(C,{value:"\u6d4b\u8bd5"},"\u6d4b\u8bd5"),r.a.createElement(C,{value:"\u6280\u672f\u90e8"},"\u6280\u672f\u90e8")))))},k=a(229),S=function(e){return r.a.createElement("div",{className:"toolbar"},r.a.createElement(k.a.Group,{defaultValue:e.zoom,buttonStyle:"solid",onChange:function(t){e.onZoomChange(t.target.value)}},r.a.createElement(k.a.Button,{value:"Days"},"\u5929"),r.a.createElement(k.a.Button,{value:"Months"},"\u6708"),r.a.createElement(k.a.Button,{value:"Years"},"\u5e74")))},F=function(){var e=Object(n.useState)("Days"),t=Object(l.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)({}),u=Object(l.a)(c,2),E=u[0],p=u[1],v=function(e){var t=Object(n.useReducer)(g,{data:[],loading:!1,error:!1}),a=Object(l.a)(t,2),r=a[0],o=a[1];return Object(n.useEffect)(function(){var t=!1;return function(){var a=Object(d.a)(s.a.mark(function a(){var n,r,c,i,u,d,g,E,p,v;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o({type:"FETCH_INIT"}),a.prev=1,a.next=4,_(e);case 4:for(n=a.sent,r=(r=n.data).filter(function(e){return"0000-00-00"!==e.start_time&&"0000-00-00"!==e.end_time}).map(function(e){return Object(f.a)(Object(f.a)({},e),{},{start_date:e.start_time,end_date:e.end_time,text:e.task_name,duration:e.fate})}),c=new Map,i=0;i<r.length;i++)u=r[i],c.get(u.username)||c.set(u.username,u.uid),u.parent=u.uid;d=Object(m.a)(c.entries());try{for(d.s();!(g=d.n()).done;)E=Object(l.a)(g.value,2),p=E[0],v=E[1],r.push({username:p,text:p,id:v})}catch(s){d.e(s)}finally{d.f()}console.log("data: ",r),t||o({type:"FETCH_SUCCESS",payload:r}),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(1),console.log(a.t0),t||o({type:"FETCH_ERROR"});case 19:case"end":return a.stop()}},a,null,[[1,15]])}));return function(){return a.apply(this,arguments)}}()(),function(){t=!0}},[]),[r]}({}),h=Object(l.a)(v,1)[0];console.log("state: ",h),Object(n.useEffect)(function(){p(h.data)},[h]);return r.a.createElement(r.a.Fragment,null,h.loading?r.a.createElement("div",null,"Loading ..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"gantt-header"},r.a.createElement(x,{onSortByUsername:function(){console.log(2)}}),r.a.createElement(S,{zoom:a,onZoomChange:function(e){o(e)}})),r.a.createElement(i,{zoom:a,data:E})))},T=(a(223),function(){return r.a.createElement(F,null)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},91:function(e,t,a){}},[[129,1,2]]]);
//# sourceMappingURL=main.d95862b5.chunk.js.map